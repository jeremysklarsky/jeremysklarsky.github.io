
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Jeremy Sklarsky</title>
  <meta name="author" content="Jeremy Sklarsky">

  
  <meta name="description" content="A blog about nothing (not that there&rsquo;s anything wrong with that) In my previous post, we examined NY Magazine&rsquo;s vulture.com rankings of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jeremysklarsky.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jeremy Sklarsky" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jeremy Sklarsky</a></h1>
  
    <h2>The World Wide Web is My Oyster.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="jeremysklarsky.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/07/seinfeld-rankings/">Seinfeld Rankings Part II</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-07T22:01:31-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:01 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>A blog about nothing</h3>

<h4>(not that there&rsquo;s anything wrong with that)</h4>

<p>In my <a href="/blog/2015/12/04/ranking-seinfeld-seasons/">previous post</a>, we examined NY Magazine&rsquo;s vulture.com rankings of Seinfeld episodes. By assigning each episode a points based on their rankings (I arbitrarily made a linear point scale from worst to best - unless anyone reading is a stats person and wants to weigh in&hellip;), we found that Season 5 was the runaway winner. An average Season 5 episode would&rsquo;ve ranked ~52nd, meaning its episodes were, on average, in the the top 1/3 of the whole show.</p>

<p>I thought it would be fun to continue this thought experiment. Who are the best writers in the history of the show? Solving this would take two wi-fi enabled flights back and forth to Tampa and a couple hours when you wake up earlier than your wife even though you&rsquo;re on vacation and you can&rsquo;t sleep in.</p>

<p>In the previous exercise, we grabbed our rankings from Vulture&rsquo;s website using a simple jQuery statement, and then iterated through the strings to get the info we needed to make our rankings. Now, we needed to get each episode&rsquo;s writer and link them up to rankings to know who is truly master of the domain.</p>

<p>I&rsquo;ll show some code, but if you&rsquo;re bored or uninterested, just skip to the bottom for the summary.</p>

<h3>Writer? We&rsquo;re talking about a sitcom</h3>

<p>Luckily for us, there is a free API called <a href="http://omdbapi.com">The Open Movie Database</a> that gives us most of the same information found on IMDB. I may do something with IMDB ratings at some point, but to be honest, they are mostly useless and would probably yield very little information of interest. Anyhow, OMDb has a very simple API as far as TV series are concerned. There are 2 methods I used. The first is <code>http://www.omdbapi.com/?t={show}&amp;Season={season#}</code>. A request for Seinfeld&rsquo;s first season <code>http://www.omdbapi.com/Season=1</code> returns a nice JSON object:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nx">Title</span><span class="o">:</span> <span class="s2">&quot;Seinfeld&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">Season</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">Episodes</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nx">Title</span><span class="o">:</span> <span class="s2">&quot;The Stakeout&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Released</span><span class="o">:</span> <span class="s2">&quot;1990-05-31&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Episode</span><span class="o">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbRating</span><span class="o">:</span> <span class="s2">&quot;7.8&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbID</span><span class="o">:</span> <span class="s2">&quot;tt0697784&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nx">Title</span><span class="o">:</span> <span class="s2">&quot;The Robbery&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Released</span><span class="o">:</span> <span class="s2">&quot;1990-06-07&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Episode</span><span class="o">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbRating</span><span class="o">:</span> <span class="s2">&quot;7.7&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbID</span><span class="o">:</span> <span class="s2">&quot;tt0697768&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nx">Title</span><span class="o">:</span> <span class="s2">&quot;Male Unbonding&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Released</span><span class="o">:</span> <span class="s2">&quot;1990-06-14&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Episode</span><span class="o">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbRating</span><span class="o">:</span> <span class="s2">&quot;7.6&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbID</span><span class="o">:</span> <span class="s2">&quot;tt0697645&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nx">Title</span><span class="o">:</span> <span class="s2">&quot;The Stock Tip&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Released</span><span class="o">:</span> <span class="s2">&quot;1990-06-21&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">Episode</span><span class="o">:</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbRating</span><span class="o">:</span> <span class="s2">&quot;7.7&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">imdbID</span><span class="o">:</span> <span class="s2">&quot;tt0697788&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">],</span>
</span><span class='line'>  <span class="nx">Response</span><span class="o">:</span> <span class="s2">&quot;True&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now, we simply make this call for each season of the show, incrementing up the season number until there is no response. Along the way, we collect the <code>imdbID</code>&rsquo;s for our second call. Then, we use the <code>i={imdbID}</code> API method for each episode we collected. A sample response would look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="err">Title:</span> <span class="nt">&quot;Male Unbonding&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Season:</span> <span class="nt">&quot;1&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Episode:</span> <span class="nt">&quot;4&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Runtime:</span> <span class="nt">&quot;23 min&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Genre:</span> <span class="nt">&quot;Comedy&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Director:</span> <span class="nt">&quot;Tom Cherones&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Writer:</span> <span class="nt">&quot;Larry David (created by), Jerry Seinfeld (created by), Larry David, Jerry Seinfeld&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">Actors:</span> <span class="nt">&quot;Jerry Seinfeld, Julia Louis-Dreyfus, Michael Richards, Jason Alexander&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">imdbRating:</span> <span class="nt">&quot;7.6&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">imdbID:</span> <span class="nt">&quot;tt0697645&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="err">seriesID:</span> <span class="nt">&quot;tt0098904&quot;</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, we just have to parse the <code>Writer</code> attribute, split on the commas and filter out any of the writer credits we want to ignore (e.g. &ldquo;created by&rdquo;, &ldquo;story by&rdquo;, &ldquo;story editor&rdquo;, etc). We are just interested in the main billed writer for this experiment.</p>

<h3>It&rsquo;s going in the vault</h3>

<p>So, now that it looks like I&rsquo;m going to be making upwards of 180 or so API calls, I&rsquo;m going to want to persist this data so I don&rsquo;t have to make all these calls over and over again. We&rsquo;ll make a few tables: Episodes, Seasons, Writers, and EpisodeWriters (a join table since an episode can have multiple writers.) Join them up and we&rsquo;re ready to go.</p>

<p>Working in a Ruby ActiveRecord enabled environment makes this all really easy. Maybe I&rsquo;ll do this all again in Node one day..</p>

<p>Here&rsquo;s the <code>Writer</code> class:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Writer</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:episode_writers</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:episodes</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:episode_writers</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">total_points</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">episodes</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nb">self</span><span class="o">.</span><span class="n">episodes</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span><span class="o">|</span><span class="n">ep</span><span class="o">|</span> <span class="n">ep</span><span class="o">.</span><span class="n">points</span><span class="p">}</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span> <span class="p">:</span> <span class="mi">0</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">average</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">episodes</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="p">(</span><span class="n">total_points</span> <span class="o">/</span> <span class="nb">self</span><span class="o">.</span><span class="n">episodes</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">to_f</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="mi">0</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">episode_count</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">episodes</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">average_rank</span>
</span><span class='line'>    <span class="no">Episode</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="nb">self</span><span class="o">.</span><span class="n">average</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">all_time_points</span>
</span><span class='line'>    <span class="no">Writer</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">sort_by</span> <span class="p">{</span><span class="o">|</span><span class="n">writer</span><span class="o">|</span><span class="n">writer</span><span class="o">.</span><span class="n">total_points</span><span class="p">}</span><span class="o">.</span><span class="n">reverse</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">all_time_average</span>
</span><span class='line'>    <span class="no">Writer</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">sort_by</span> <span class="p">{</span><span class="o">|</span><span class="n">writer</span><span class="o">|</span><span class="n">writer</span><span class="o">.</span><span class="n">average</span><span class="p">}</span><span class="o">.</span><span class="n">reverse</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>He named names!</h3>

<p>For arguments, sake we&rsquo;ll limit our sample to those writers who contributed more than 5 episodes over the course of the series. This gives us a total of 11 writers, sorted by average episode rank (writing duos Jeff Schaffer / Alec Berg and Tom Gammill / Max Pross are listed together. Jerry and Larry, while collaborators on a lot of episodes, are listed separately because of Larry&rsquo;s significant solo career). Ready?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">|</span> <span class="no">Writer</span>          <span class="o">|</span> <span class="no">Average</span> <span class="no">Rank</span> <span class="o">|</span> <span class="no">Total</span> <span class="no">Points</span> <span class="o">|</span> <span class="no">Episode</span> <span class="no">Count</span> <span class="o">|</span>
</span><span class='line'><span class="o">|-----------------|--------------|--------------|---------------|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Schaffer</span> <span class="o">/</span> <span class="no">Berg</span> <span class="o">|</span> <span class="mi">48</span><span class="o">.</span><span class="mi">9</span>         <span class="o">|</span> <span class="mi">1429</span>         <span class="o">|</span> <span class="mi">12</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Carol</span> <span class="no">Leifer</span>    <span class="o">|</span> <span class="mi">54</span>           <span class="o">|</span> <span class="mi">570</span>          <span class="o">|</span> <span class="mi">5</span>             <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">David</span> <span class="no">Mandel</span>    <span class="o">|</span> <span class="mi">61</span><span class="o">.</span><span class="mi">4</span>         <span class="o">|</span> <span class="mi">746</span>          <span class="o">|</span> <span class="mi">7</span>             <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Larry</span> <span class="no">Charles</span>   <span class="o">|</span> <span class="mi">67</span><span class="o">.</span><span class="mi">1</span>         <span class="o">|</span> <span class="mi">1404</span>         <span class="o">|</span> <span class="mi">14</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Greg</span> <span class="no">Kavett</span>     <span class="o">|</span> <span class="mi">82</span><span class="o">.</span><span class="mi">7</span>         <span class="o">|</span> <span class="mi">768</span>          <span class="o">|</span> <span class="mi">9</span>             <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Andy</span> <span class="no">Robin</span>      <span class="o">|</span> <span class="mi">84</span><span class="o">.</span><span class="mi">6</span>         <span class="o">|</span> <span class="mi">917</span>          <span class="o">|</span> <span class="mi">11</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Gammill</span> <span class="o">/</span> <span class="no">Pross</span> <span class="o">|</span> <span class="mi">90</span>           <span class="o">|</span> <span class="mi">936</span>          <span class="o">|</span> <span class="mi">12</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Larry</span> <span class="no">David</span>     <span class="o">|</span> <span class="mi">93</span><span class="o">.</span><span class="mi">2</span>         <span class="o">|</span> <span class="mi">3739</span>         <span class="o">|</span> <span class="mi">50</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Jerry</span> <span class="no">Seinfeld</span>  <span class="o">|</span> <span class="mi">97</span><span class="o">.</span><span class="mi">1</span>         <span class="o">|</span> <span class="mi">1064</span>         <span class="o">|</span> <span class="mi">15</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Peter</span> <span class="no">Mehlman</span>   <span class="o">|</span> <span class="mi">99</span><span class="o">.</span><span class="mi">2</span>         <span class="o">|</span> <span class="mi">1307</span>         <span class="o">|</span> <span class="mi">19</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Spike</span> <span class="no">Feresten</span>  <span class="o">|</span> <span class="mi">100</span><span class="o">.</span><span class="mi">5</span>        <span class="o">|</span> <span class="mi">540</span>          <span class="o">|</span> <span class="mi">8</span>             <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p>Very interesting! Larry David is by far the biggest (billed) individual contributor to the show, but his average episode ranks towards the bottom. By contrast, Jeff Schaffer and Alec Berg, who later went on to create the league have both the second most total points (behind Larry) and the highest average. Here&rsquo;s a list of their episodes and rankings:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="s1">&#39;The Summer of George&#39;</span> <span class="ss">Rank</span><span class="p">:</span> <span class="mi">9</span>
</span><span class='line'><span class="s1">&#39;The Secret Code&#39;</span>      <span class="ss">Rank</span><span class="p">:</span> <span class="mi">10</span>
</span><span class='line'><span class="s1">&#39;The Gymnast&#39;</span>          <span class="ss">Rank</span><span class="p">:</span> <span class="mi">19</span>
</span><span class='line'><span class="s1">&#39;The Doodle&#39;</span>           <span class="ss">Rank</span><span class="p">:</span> <span class="mi">33</span>
</span><span class='line'><span class="s1">&#39;The Voice&#39;</span>            <span class="ss">Rank</span><span class="p">:</span> <span class="mi">38</span>
</span><span class='line'><span class="s1">&#39;The Butter Shave&#39;</span>     <span class="ss">Rank</span><span class="p">:</span> <span class="mi">47</span>
</span><span class='line'><span class="s1">&#39;The Seven&#39;</span>            <span class="ss">Rank</span><span class="p">:</span> <span class="mi">48</span>
</span><span class='line'><span class="s1">&#39;The Maid&#39;</span>             <span class="ss">Rank</span><span class="p">:</span> <span class="mi">50</span>
</span><span class='line'><span class="s1">&#39;The Chicken Roaster&#39;</span>  <span class="ss">Rank</span><span class="p">:</span> <span class="mi">57</span>
</span><span class='line'><span class="s1">&#39;The Foundation&#39;</span>       <span class="ss">Rank</span><span class="p">:</span> <span class="mi">64</span>
</span><span class='line'><span class="s1">&#39;The Calzone&#39;</span>          <span class="ss">Rank</span><span class="p">:</span> <span class="mi">97</span>
</span><span class='line'><span class="s1">&#39;The Strike&#39;</span>           <span class="ss">Rank</span><span class="p">:</span> <span class="mi">127</span>
</span></code></pre></td></tr></table></div></figure>


<p>10 of 12 episodes are considered by Vulture above average, 9 of 12 in the top 1/3, 3 in the Top 20, and only 1 in the bottom 1/3 of episodes. In fact, an entire season of Schaffer/Berg episodes would&rsquo;ve ranked higher than Season 5, the overall top ranked season.</p>

<p>Larry, on the other hand, has the dubious distinction of having written both Vulture&rsquo;s top and bottom ranked episode. Of course, calling &ldquo;The Finale&rdquo; the worst Seinfeld episode is a stunt. It&rsquo;s barely a Seinfeld episode and outside of the music and cast is nothing like the rest of the series. So it is at this point, perhaps, the ranking system breaks down. &ldquo;The Contest&rdquo; is not only the most acclaimed Seinfeld episodes, it is roundly considered one of the greatest scripted half hours in television history. In fact, it&rsquo;s critical success is partly what lead to the explosion in Seinfeld&rsquo;s popularity. Without it, there might not have been five more seasons. Is it worth only 1 more point in the rankings than the next best episode on the list (&ldquo;The Subway&rdquo;)? I can&rsquo;t say for sure.</p>

<p>I should, however, note that while Larry and Jerry&rsquo;s rankings are somewhat low this is skewed data. It is said that the pair (through the end of Season 7, and later Jerry alone) had final say on all scripts and did the last pass of every episode. They tended to take billing as an episode&rsquo;s writer less and less throughout the series and were more likely the billed writers in the early, low ranking seasons. Whether this is reflective of their contributions to the show&rsquo;s writing I cannot say, but thought it worth mentioning.</p>

<h3>Directors</h3>

<p>We can do a similar analysis using virtually the same code, just swapping out <code>Writer</code> for <code>Director</code> because object oriented metaprogramming is cool like that.</p>

<p>We&rsquo;ll just check in on the two directors who directed the overwhelming majority of the show&rsquo;s episodes: Tom Cherones (Seasons 1-5) and Andy Ackerman (6-9). My gut told me that Ackerman would have better stats, which he did, though slightly.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">|</span> <span class="no">Director</span>        <span class="o">|</span> <span class="no">Average</span> <span class="no">Rank</span> <span class="o">|</span> <span class="no">Total</span> <span class="no">Points</span> <span class="o">|</span> <span class="no">Episode</span> <span class="no">Count</span> <span class="o">|</span>
</span><span class='line'><span class="o">|-----------------|--------------|--------------|---------------|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Andy</span> <span class="no">Ackerman</span>   <span class="o">|</span> <span class="mi">77</span>           <span class="o">|</span> <span class="mi">6828</span>         <span class="o">|</span> <span class="mi">75</span>            <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="no">Tom</span> <span class="no">Cherones</span>    <span class="o">|</span> <span class="mi">90</span>           <span class="o">|</span> <span class="mi">5308</span>         <span class="o">|</span> <span class="mi">68</span>            <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/04/ranking-seinfeld-seasons/">Ranking Seinfeld Seasons</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-04T09:41:15-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:41 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>I was recently sent an email containing a link to <a href="http://www.vulture.com/2015/06/every-seinfeld-episode-ranked.html">NYMag/Vulture&rsquo;s rankings of every Seinfeld episode</a>, which they put out in response to Hulu releasing the entire series. What follows is my response to the group email.</em></p>

<p>All:
Using my new fangled programming skills I was able to parse the text of the article and crunch a couple of numbers. I think there are some legitimate grips with some individual episode rankings. But with the exception of what Shosh might deem a too highly ranked Season 8, I think in aggregate the total season rankings ring somewhat true to me.</p>

<p>What I&rsquo;ve done is take each ranking and assign it it&rsquo;s inverse point value (total # of episodes minus ranking). So for example, the #2 ranked episode gets 168 points and the 167th ranked episode gets 2 points. I did both point totals and averages just to see if there would be any discrepancy due to the early seasons having fewer episodes. There was no discrepancy.</p>

<p>I also was able to infer, based on the average score, what the &ldquo;average&rdquo; episode&rsquo;s rank would&rsquo;ve been. So for example, the average season 5 episode would&rsquo;ve ranked about 52nd.</p>

<p>According to this article, the overall best season is Season 5, and by a long shot. The average season 5 episode ranks 21 places hire then the next best season, #6. As expected, season 1, 2, and 3 are ranked lowest (and in that order) both in total score and average score.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| SEASON | TOTALS | AVERAGES | AVERAGE RANK |
</span><span class='line'>|--------|--------|----------|--------------|
</span><span class='line'>| 5      | 2455   | 116.9    | 52.1         |
</span><span class='line'>| 6      | 2106   | 95.72    | 73.3         |
</span><span class='line'>| 9      | 2102   | 95.54    | 73.5         |
</span><span class='line'>| 8      | 1937   | 88.04    | 81.0         |
</span><span class='line'>| 4      | 1703   | 77.4     | 91.6         |
</span><span class='line'>| 7      | 1609   | 76.61    | 92.4         |
</span><span class='line'>| 3      | 1544   | 70.18    | 98.8         |
</span><span class='line'>| 2      | 652    | 54.33    | 114.7        |
</span><span class='line'>| 1      | 73     | 18.25    | 150.8        |
</span></code></pre></td></tr></table></div></figure>


<h2>Tech notes, if you&rsquo;re interested</h2>

<p>Used jQuery to scrape the website
<code>$('p:contains("(Season")').each(function(i, item){console.log(item.textContent.split(").")[0])})</code></p>

<p>Defaulted back to Ruby for the rest, putting the list into an array <code>STRING</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">STRING</span> <span class="o">=</span> <span class="o">[</span>
</span><span class='line'>  <span class="s1">&#39;169. &quot;The Puerto Rican Day Parade&quot; (Season 9&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;168. &quot;The Outing&quot; (Season 4&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;167. &quot;The Finale&quot; (Season 9&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;166. &quot;The Jacket&quot; (Season 2&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;165. &quot;The Tape&quot; (Season 3&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;164. &quot;The Deal&quot; (Season 2&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="n">etc</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">convert_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span><span class='line'>  <span class="mi">169</span><span class="o">-</span><span class="n">num</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">sort_hash</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">hash</span><span class="o">.</span><span class="n">sort_by</span> <span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span><span class="p">}</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">to_h</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">rankings_hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">|</span> <span class="n">h</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="o">[]</span> <span class="p">}</span>
</span><span class='line'><span class="n">average_score</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'><span class="n">total_score</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="no">STRING</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">rank</span><span class="o">|</span>
</span><span class='line'>  <span class="n">num</span> <span class="o">=</span> <span class="n">convert_num</span><span class="p">(</span><span class="n">rank</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">to_i</span><span class="p">)</span>
</span><span class='line'>  <span class="n">season</span> <span class="o">=</span> <span class="n">rank</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; (Season &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>  <span class="n">rankings_hash</span><span class="o">[</span><span class="n">season</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">to_i</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">rankings_hash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">season</span><span class="p">,</span> <span class="n">scores</span><span class="o">|</span>
</span><span class='line'>  <span class="n">total_score</span><span class="o">[</span><span class="n">season</span><span class="o">]</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span>
</span><span class='line'>  <span class="n">average_score</span><span class="o">[</span><span class="n">season</span><span class="o">]</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">inject</span><span class="p">{</span> <span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">el</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">el</span> <span class="p">}</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">scores</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">sort_hash</span><span class="p">(</span><span class="n">total_score</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">sort_hash</span><span class="p">(</span><span class="n">average_score</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/18/the-good-parts/">The Good Parts</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-18T15:53:19-05:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I recently finished reading &ldquo;Javascript: The Good Parts&rdquo; in an effort to expand my understanding of Javascript, the language I&rsquo;ve used on a daily basis since starting as a UI developer at MediaMath.</p>

<p>I was a little let down by the experience. Much of it was familiar to me - as I&rsquo;ve intuited a great deal from writing Javascript for the better part of the last 6 months. The &ldquo;good parts&rdquo; to which the author refers are mostly a set of flexible capabilities that allow for a degree of customization on the part of the user. The author highlights two such categories, namely, assigning Functions to objects and how the language handles inheritance.</p>

<p>I was hoping for more insight into the inner workings of the language. The title is a misnomer and should perhaps be entitled &ldquo;Javascript: Overcoming the Bad Parts.&rdquo; The author demonstrates a series of patterns he has implemented to make assigning functions and creating class-like objects a bit easier. Perhaps I was expecting something different.</p>

<p>Instead, I thought I would highlight my new understanding of one of the fundamental aspects of Javascript I&rsquo;d heard but scarcely understood. The curicculum at Flatiron School was largely based around Ruby, its ecosystem, and the Rails MVC framework. Javascript, at least while I was there, was just used as a way to manipulate the DOM and make our sites interactive.</p>

<h3>Functions: First or Second Class Citizen?</h3>

<p>I was able to grasp pretty quickly what people meant by &ldquo;Objects being first class citizens&rdquo; in Ruby. While a &ldquo;Class&rdquo; is a technically a special type of object whose class is &ldquo;Class,&rdquo; this is a bit reductive. Most Ruby programming, especially in a Rails environment, is organized around classes. Every instance of a class is an object and they all have the same abilities. All objects inherit directly from their class. Their only differences are the literal values stored in instance variables. We can pass objects around and store objects in variables - anything with a return value of any kind (which is itself an object). They have to be literal &ldquo;things.&rdquo; A method is not a literal thing - it is a set of instructions that when executed, are turned into a thing.</p>

<p>Javascript is different. We are told that functions, not objects, are first class citizens in Javascript. I never quite understood what that meant.</p>

<p>As Crockford puts it:</p>

<blockquote><p>The lineage of an object is irrelevant. What matters about an object is what it can do, not what it is descended from.</p></blockquote>

<p>You can make class-like objects in Javascript that have custom functions, constants, and defaults. Then you can make other objects inherit from that object - whether prototypical or pseudoclassical. It&rsquo;s not really important. But something really caught my eye in the chapter about arrays.</p>

<blockquote><p>Because an array is really an object, we can add methods directly to an individual array.</p></blockquote>

<p>Mind === blown. In Ruby, the only way to add an Array method would be to extend it to the entire class from which the object descended. Then, ALL arrays in the program would have access to that method. In Javascript, once an object is created, it doesn&rsquo;t really communicate back up to the mothership. We can assign a function to a single array and it would <em>only</em> affect that specific object.</p>

<h3>Examples</h3>

<p>So, for example, if you had an array, <code>var myArray = [1,2,3];</code>, you could define a function on that array:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">myArray</span><span class="p">.</span><span class="nx">myLength</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This helped me get to an understanding of the difference between Ruby and Javascript and their treatment of objects and functions. Take an object in Ruby, say, <code>person = Person.new</code>. To set a property, or instance variable, we&rsquo;d need instance method that would allow us to set that instance variable:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Class</span> <span class="no">Person</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">instance_variable</span><span class="o">=</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@instance_variable</span> <span class="o">=</span> <span class="n">arg</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>That variable could only be another object - a standard data type like a <code>String</code>, <code>Array</code>, <code>Float</code>, or an instance of another class. But it would have to be an object.</p>

<p>In Javascript, we not only don&rsquo;t need permission from the class to set any property on our objects (no more of those nasty <code>No Method</code> errors!), but the value can either be literal data types or <em>functions</em> themselves. That&rsquo;s why we&rsquo;re able to make a custom function and assign it to an array. There&rsquo;s no magic happening with the Array Prototype, we&rsquo;re simply setting a property on the array, like <code>length</code>, only our array doesn&rsquo;t care if the property is equal to a string, a number, an object, another array, or even a function!</p>

<p>Here&rsquo;s the fun part. We can actually see the evidence! In a browser console, when we write <code>console.dir(myArray)</code>, we get a very interesting output.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="mi">0</span><span class="o">:</span> <span class="mi">1</span>
</span><span class='line'><span class="mi">1</span><span class="o">:</span> <span class="mi">2</span>
</span><span class='line'><span class="mi">2</span><span class="o">:</span> <span class="mi">3</span>
</span><span class='line'><span class="nx">length</span><span class="o">:</span> <span class="mi">3</span>
</span><span class='line'><span class="nx">myLength</span><span class="o">:</span> <span class="p">()</span>
</span><span class='line'><span class="nx">__proto__</span><span class="o">:</span> <span class="nb">Array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>The array itself has 3 numbered properties - also known as the indeces of the array (<code>myArray[1]</code>, for example), a property called <code>length</code>, and a property called <code>myLength</code>. That&rsquo;s the function we made. Undeneath that is <code>__proto__: Array[0]</code>. I won&rsquo;t list all the details, but expanding that list will show us every function and property our array inherited from the Array Protoype object that birthed it. <code>myLength()</code> is stored as a property on the object. The object still has access to all the functions it got from its parent object, but that list is untouched. This is the proof that you can not only store functions in variables, but you can set them as property values in objects. That&rsquo;s the guts of how functions get &ldquo;first class citizen&rdquo; status in the javascript universe.</p>

<p>Of course, we could have always defined myLength as a function on <code>Array.protoype</code>. This would have extended the function all other arrays. Another one of Javascript&rsquo;s &ldquo;good parts&rdquo; is that allows for both styles of inheritance.</p>

<h3>Callbacks! A Good Part!</h3>

<p>Similarly, Ruby only allows objects to be passed into methods as arguments, but because of this feature in Javascript we can pass functions in as arguments. Because these functions don&rsquo;t have to be invoked, or evaluated, until they are called, we can pass in functions as callbacks. They don&rsquo;t even have to be named, we can declare an anonymous function right there in the invoking of another function.</p>

<p>I&rsquo;ve been using this stuff without even realizing it. Take this example from one of our Backbone views:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">orgId</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'><span class="nx">defaultEntity</span><span class="o">:</span> <span class="s1">&#39;advertisers&#39;</span><span class="p">,</span>
</span><span class='line'><span class="nx">segments</span><span class="o">:</span> <span class="p">[],</span>
</span><span class='line'>
</span><span class='line'><span class="nx">stripId</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/[(][0-9]+[)]/</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>In like 10 lines of code, we have examples of 4 properties, each a different thing: an integer, a string, an array, and a function. Javascript doesn&rsquo;t care. This gives you such incredible flexibility. That, to me, would constitute a &ldquo;Good Part!&rdquo;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/13/accessing-shadow-dom-elements-with-selenium-webdriver/">Accessing Shadow DOM Elements With Selenium Webdriver</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-13T10:33:35-04:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:33 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://webcomponents.org/">Web components</a> are a fantastic way to speed up front end development and standardize design aspects across a large team. But they pose a huge problem when it comes to writing tests.</p>

<p>Shadow DOM elements are not accessible to selenium-webdriver&rsquo;s traditional means of searching the window for HTML elements. Using javascript and selenium&rsquo;s <code>executeScript()</code> function, you can find the element or value that is hidden by a shadow DOM and return its value or WebElement.</p>

<p>The easiest nut to crack (cross your fingers) is when a site has already incorporated jQuery. This will allow you to use a <code>$</code> selector to access elements within the shadow DOM. This is one of those programming problems where I spent hours working out the solution and the answer was a single line of code. Assuming you&rsquo;ve named your selenium-webdriver instance <code>driver</code>, you can simply run the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">driver</span><span class="p">.</span><span class="nx">executeScript</span><span class="p">(</span><span class="s2">&quot;return $(&#39;body /deep/ &lt;#yourSelector&gt;&#39;)&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>What this does is have selenium execute a literal javascript in your browser instance. By putting <code>return</code> at the front of the javascript, it will send a value back to your test file.</p>

<p>The command above will return a web element. In the case of the test I was writing, I wanted to check to see if some text matched my expectation. (Author&rsquo;s note: test was written in Javascript using the mocha framework and Chai &lsquo;should&rsquo; assertion syntax).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">driver</span><span class="p">.</span><span class="nx">executeScript</span><span class="p">(</span><span class="s2">&quot;return $(&#39;body /deep/ ._mm_column&#39;)[0].textContent&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">title</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">title</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">contain</span><span class="p">(</span><span class="nx">segmentName</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s it. Now I can access the shadow DOM.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/28/checksum-gives-me-indigestion/">Checksum Gives Me Indigestion</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-28T17:11:09-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>5:11 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I encountered a problem I hadn&rsquo;t thought much about before. How can I tell if the contents of two files are the same? If we&rsquo;re directly comparing two files, that should be pretty simple. Given 3 files, how can we tell? Simply, we&rsquo;d read the contents of the file and figure out if those objects have equivalency.</p>

<p>Let&rsquo;s make 3 files.
<code>test1.txt</code> and <code>test2.txt</code> will contain the string &ldquo;THIS IS SOME TEXT.&rdquo;
<code>test3.txt</code> will contain &ldquo;THIS IS SOME OTHER TEXT.&rdquo;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">one</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'><span class="n">two</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'><span class="n">three</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test3.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">one</span> <span class="o">==</span> <span class="n">two</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">one</span> <span class="o">==</span> <span class="n">three</span>
</span></code></pre></td></tr></table></div></figure>


<p>What do we expect this program to output? We expect line 5 to evaluate the <code>true</code> and line 6 to evaluate to <code>false</code>, which it does.</p>

<p>This is a good solution but it is not scalable. What if instead of only comparing three files, we wanted to compare a file many times larger across hundreds of thousands of files? That would be a nightmare. So we need to find a more efficient way to do this.</p>

<p>Why would we need to do this you ask? Well, if we&rsquo;re maintaining a file server or database we&rsquo;d need a quick way to eliminate duplicate files to keep the server lean and prevent confusion later down the line. Another common application for needing to check file equivalency is for <a href="http://en.wikipedia.org/wiki/Checksum">checking your data&rsquo;s integrity during transmission or storage</a>.</p>

<p>How is this done? By creating something called a checksum. <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChAdvChecksums.html">Wireshark provides this summary:</a></p>

<blockquote><p>A checksum is basically a calculated summary of such a data portion.
Network data transmissions often produce errors, such as toggled, missing or duplicated bits. As a result, the data received might not be identical to the data transmitted, which is obviously a bad thing.
Because of these transmission errors, network protocols very often use checksums to detect such errors. The transmitter will calculate a checksum of the data and transmits the data together with the checksum. The receiver will calculate the checksum of the received data with the same algorithm as the transmitter. If the received and calculated checksums dont match a transmission error has occurred.</p></blockquote>

<p>In other words, data transmitted over a network is being spell checked as it is copied.</p>

<h3>Checksums and Ruby Data Structures</h3>


<p>What&rsquo;s another reason for this? Storing a bunch of files in memory gets expensive very quickly. If files all have different names, then the only way to search for duplicate values is by reading the contents of a file and then comparing it to all the values stored in memory, like we did in the first example. What if instead we just stored a checksum, a smaller digital fingerprint of the file&rsquo;s contents? Then we have any number of ways to store, search, or compare our data.</p>

<p>Ruby doesn&rsquo;t natively support hashing algorithms, but fortunately the <code>Digest</code> module and the <code>MD5</code> hashing algorithim are built into the standard library so all we have to do is require them.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;digest/md5&#39;</span>
</span><span class='line'><span class="n">one</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">two</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">three</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test3.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="o">*</span><span class="n">files</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">|</span> <span class="n">h</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="o">[]</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">files</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
</span><span class='line'>    <span class="c1"># for each file, read the contents</span>
</span><span class='line'>    <span class="c1"># and store a checksum as a key in the hash</span>
</span><span class='line'>    <span class="n">md5</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">md5</span> <span class="o">&lt;&lt;</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">[</span><span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="n">file</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">hash</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">checksum</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">,</span> <span class="n">three</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running this program results in this: <code>=&gt; {"81e3a7e854d334e82f75a2bcdbe6a3da"=&gt;[#&lt;File:test1.txt&gt;, #&lt;File:test2.txt&gt;], "32b2eccab2dcc035c50820d0943e5b94"=&gt;[#&lt;File:test3.txt&gt;]}</code></p>

<p>So even though these were three different files, our checksum algorithm was able to determine that the first two files have equivalent values. What&rsquo;s the application for this?</p>

<p>Searching through a hash for a key is fast - much faster than iterating through an array. So if we wanted to find duplicate files, instead of using the file name (an intuitive choice) for the key, we could store this checksum value as the key. In a sense, the checksum is both the key AND the value. With its place reserved in memory, all we&rsquo;d have to do is check to see if the new file&rsquo;s checksum exists as a key in our hash.</p>

<p>Consider this program. We initialize a <code>Checker</code> class with two files, <code>test1.txt</code> and <code>test3.txt</code>. Then we run our <code>unique?</code> function on <code>test2.txt</code>. Remember, files 1 and 2 have the same contents. We now have very small fingerprints of 1 and 3 stored in memory, and instead of reading their entire contents to check them against our new file, we simply create a fingerprint for the new file and compare it to our current set of fingerprints.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Checker</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;pry&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;digest/md5&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:my_hash</span><span class="p">,</span> <span class="ss">:files</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="o">*</span><span class="n">files</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@files</span> <span class="o">=</span> <span class="n">files</span>
</span><span class='line'>    <span class="n">checksum</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">checksum</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@my_hash</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="n">files</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
</span><span class='line'>      <span class="c1"># for files we want to store</span>
</span><span class='line'>      <span class="c1"># create a checksum, create a key value pair</span>
</span><span class='line'>      <span class="c1"># :checksum =&gt; file</span>
</span><span class='line'>      <span class="n">md5</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>      <span class="n">md5</span> <span class="o">&lt;&lt;</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'>      <span class="vi">@my_hash</span><span class="o">[</span><span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="o">]</span> <span class="o">=</span> <span class="n">file</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="vi">@my_hash</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">unique?</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># to check if a file is unique compared to the </span>
</span><span class='line'>    <span class="c1"># rest of the system</span>
</span><span class='line'>    <span class="n">md5</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">md5</span> <span class="o">&lt;&lt;</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'>    <span class="c1"># will return true if the file&#39;s checksum is unique</span>
</span><span class='line'>    <span class="c1"># else, =&gt; false</span>
</span><span class='line'>    <span class="o">!</span><span class="n">my_hash</span><span class="o">.</span><span class="n">has_key?</span><span class="p">(</span><span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#load our files into memory</span>
</span><span class='line'><span class="n">one</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test1.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">two</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">three</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test3.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#create a new checker instance</span>
</span><span class='line'><span class="n">check</span> <span class="o">=</span> <span class="no">Checker</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">three</span><span class="p">)</span>
</span><span class='line'><span class="c1"># check if new file is unique</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">check</span><span class="o">.</span><span class="n">unique?</span><span class="p">(</span><span class="n">two</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Since the checksum value already exists in the hash, the <code>check.unique?(two)</code> returns false.</p>

<p><a href="http://en.wikipedia.org/wiki/MD5">More on MD5</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/26/life-or-death-the-emperors-proposition/">Life or Death? The Emperor&#8217;s Proposition</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-26T15:53:30-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Time for another probability brain teaser. This one comes to us from <a href="http://www.braingle.com/brainteasers/15446/life-or-death-the-emperors-proposition.html">Braingle</a>. Here&rsquo;s a quick rundown of the problem:</p>

<blockquote><p>You are a prisoner sentenced to death. The Emperor offers you a chance to live by playing a simple game. He gives you 50 black marbles, 50 white marbles and 2 empty bowls. He then says, &ldquo;Divide these 100 marbles into these 2 bowls. You can divide them any way you like as long as you use all the marbles. Then I will blindfold you and mix the bowls around. You then can choose one bowl and remove ONE marble. If the marble is WHITE you will live, but if the marble is BLACK&hellip; you will die.&rdquo;</p></blockquote>

<p>How do I want to solve this? Unless I can figure out the answer with my own intuition, we&rsquo;re going to have to brute force this thing. So, the most obvious thing to do would be set up a simulation where we:</p>

<p> Figure out all possible marble arrangement scenarios<br>
 Run each scenario a lot of times and check how many times we survive<br>
Sort the results by % of times we survivce</p>

<p>The fun part here is building a digital model of the problem. We have a couple of pieces to account for. Two &ldquo;pouches,&rdquo; 100 &ldquo;marbles,&rdquo; and a random selector. For the pouches, we&rsquo;ll use an array of two arrays, and fill it with &ldquo;marble&rdquo; elements, and a the ruby method <code>sample</code> to randomly choose which &ldquo;pouch&rdquo; to pick from, and <code>sample</code> again to pick an element from the sub-array (the pouch). In order to set this experiment up to run all at once, we&rsquo;ll collect all the pouches in a hash. This way, we can store both the pouches and some descriptive info so we can discern the results later.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Emperor</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:marble_count</span><span class="p">,</span> <span class="ss">:pouches</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">marble_count</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@marble_count</span> <span class="o">=</span> <span class="n">marble_count</span>
</span><span class='line'>    <span class="vi">@pouches</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The tricky part from a Ruby perspective is going to be populating the arrays with every possible marble arrangement. There are no limitations on how you can arrange the marbles. We don&rsquo;t need to set up both pouches, just figure out what one pouch looks like, and make the other pouch the inverse.</p>

<p>This means there can be anywhere between 0-50 white marbles in one pouch, accompanied by anywhere from 0-50 black marbles. So 51 possible white marble arrangements, each with 51 possible black marble arrangements. 51 * 51 means there are 2601 possible combinations.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">populate</span>
</span><span class='line'>    <span class="vi">@combinations</span> <span class="o">=</span> <span class="p">(</span><span class="n">marble_count</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>    <span class="n">combinations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="o">|</span>
</span><span class='line'>      <span class="n">combinations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">b</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">w</span><span class="si">}</span><span class="s2"> white, </span><span class="si">#{</span><span class="n">b</span><span class="si">}</span><span class="s2"> black&quot;</span>
</span><span class='line'>        <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span> <span class="o">[]</span><span class="p">,</span> <span class="o">[]</span> <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">w</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">true</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">b</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">false</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">(</span><span class="n">marble_count</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">true</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">(</span><span class="n">marble_count</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">false</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now, we have a hash where the key describes the contents of the first pouch (we&rsquo;ll just infer the contents of the second pouch): something like &ldquo;20 white, 30 black.&rdquo; The value is then an array with two arrays representing the pouches. But instead of &ldquo;white&rdquo; and &ldquo;black&rdquo;, we&rsquo;ll use the values <code>true</code> and <code>false</code> to represent white and black since it will be pretty easy to translate the boolean into passing or failing the Emperor&rsquo;s test.</p>

<p>Now that the pouches are filled, its time to run some tests. For each set of pouches, let&rsquo;s say we&rsquo;re going to run the test 10,000 times and store the results in a <code>results = {}</code> hash. In short, the emperor will randomly choose a pouch, and then randomly choose an element from that pouch. If it comes back true, add 1 point to the current marble configuration. For argument&rsquo;s sake, we&rsquo;ll say that if you choose a pouch with zero marbles in it, that will count as a death sentence!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">choose</span>
</span><span class='line'>    <span class="n">pouches</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">descriptor</span><span class="p">,</span> <span class="n">pouches</span><span class="o">|</span>
</span><span class='line'>      <span class="mi">10000</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">results</span><span class="o">[</span><span class="n">descriptor</span><span class="o">]</span> <span class="o">||=</span> <span class="mi">0</span>
</span><span class='line'>        <span class="n">results</span><span class="o">[</span><span class="n">descriptor</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">pouches</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">sample</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now all we have to do is sort the results hash and print the winner.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">sort</span>
</span><span class='line'>    <span class="n">results</span><span class="o">.</span><span class="n">max_by</span><span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span><span class="n">v</span><span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">print_winner</span>
</span><span class='line'>    <span class="n">winner</span> <span class="o">=</span> <span class="n">sort</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">winner</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="si">}</span><span class="s2"> will win </span><span class="si">#{</span><span class="p">(</span><span class="n">winner</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="mi">10000</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% of the time&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can delegate the entire operation to a single <code>call</code> method.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">call</span>
</span><span class='line'>    <span class="n">populate</span>
</span><span class='line'>    <span class="n">choose</span>
</span><span class='line'>    <span class="n">print_winner</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So running the following <code>Emperor.new(100).call</code> gives us the following result:
<code>1 white, 0 black will win 74.96% of the time</code></p>

<p>Interesting! The best scenario is putting one white marble in the first pouch, and the remaining 49 white and all 50 of the black marbles in the second pouch.</p>

<p>Why is this the case? An even split of marbles will produce odds of 50%. But if we limit the range of possiblities for the one of the pouches, we can guarantee that every time the emperor picks that pouch we get the desired outcome, while picking the second pouch is <i>almost</i> a 50/50 shot. So we get closer and closer to 75% chance of living. That&rsquo;s really the best odds this poor sap can hope for.</p>

<p><i>Complete code</i></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Emperor</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:marble_count</span><span class="p">,</span> <span class="ss">:pouches</span><span class="p">,</span> <span class="ss">:combinations</span><span class="p">,</span> <span class="ss">:results</span><span class="p">,</span> <span class="ss">:sorted_results</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">marble_count</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@marble_count</span> <span class="o">=</span> <span class="n">marble_count</span>
</span><span class='line'>    <span class="vi">@pouches</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="vi">@results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">populate</span>
</span><span class='line'>    <span class="vi">@combinations</span> <span class="o">=</span> <span class="p">(</span><span class="n">marble_count</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>    <span class="n">combinations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">w</span><span class="o">|</span>
</span><span class='line'>      <span class="n">combinations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">b</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">w</span><span class="si">}</span><span class="s2"> white, </span><span class="si">#{</span><span class="n">b</span><span class="si">}</span><span class="s2"> black&quot;</span>
</span><span class='line'>        <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span> <span class="o">[]</span><span class="p">,</span> <span class="o">[]</span> <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">w</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">true</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">b</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">false</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">(</span><span class="n">marble_count</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">true</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">(</span><span class="n">marble_count</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>          <span class="n">pouches</span><span class="o">[</span><span class="nb">name</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="kp">false</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">choose</span>
</span><span class='line'>    <span class="n">pouches</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">descriptor</span><span class="p">,</span> <span class="n">pouches</span><span class="o">|</span>
</span><span class='line'>      <span class="mi">10000</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">results</span><span class="o">[</span><span class="n">descriptor</span><span class="o">]</span> <span class="o">||=</span> <span class="mi">0</span>
</span><span class='line'>        <span class="n">results</span><span class="o">[</span><span class="n">descriptor</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">pouches</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">sample</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sort</span>
</span><span class='line'>    <span class="n">results</span><span class="o">.</span><span class="n">max_by</span><span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span><span class="n">v</span><span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">print_winner</span>
</span><span class='line'>    <span class="n">winner</span> <span class="o">=</span> <span class="n">sort</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">winner</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="si">}</span><span class="s2"> will win </span><span class="si">#{</span><span class="n">winner</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="mi">10000</span><span class="o">.</span><span class="mi">0</span><span class="si">}</span><span class="s2">% of the time&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span>
</span><span class='line'>    <span class="n">populate</span>
</span><span class='line'>    <span class="n">choose</span>
</span><span class='line'>    <span class="n">print_winner</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Emperor</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">call</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/12/so-long/">So Long, Farewell, Auf Wiedersehen, Goodbye</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-12T08:17:07-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:17 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Our time at Flatiron is coming to an end. While we still have 2 weeks left, I thought it would be a good time to reflect back on what has transpired over the last 10 weeks. In the run up to starting school, I constantly searched for blog posts by Flatiron students about the experience and read whatever I could find. What I didnt find, however, were as many posts that offered advice on how to best take advantage of the course. So I thought it would be useful to give some advice to myself of 10 weeks ago.</p>

<p><a href="url"><img src="http://i.imgur.com/0pS9BtG.jpg" align="inline-block" height="250" width="250" ></a>
<br>
Caption: Me Ten Weeks Ago</p>

<h3>#1. Labs exist for you, not the other way around</h3>


<p>Trying to complete every single lab as they are deployed looks like this:
<img src="http://media.giphy.com/media/slRJ0gdcWKCD6/giphy.gif" alt="Lucy" /></p>

<p><a href="https://github.com/snags88">While it is not impossible to finish every lab</a>, that shouldnt be your primary goal. At Flatiron, there are no grades and the points dont matter. Really understanding a few labs will be far more valuable than just getting the tests to pass on a lot. The labs will always be there for you - this 12 week period where your entire job is to learn new things wont be.</p>

<h3>#2. Build side projects</h3>


<p>Theres a reason the end of the semester culminates in project mode. Building things from scratch takes the training wheels off and takes you out of your comfort zone of programming to someone elses test. In nearly all of my group projects, we at some point encountered a problem that I had seen before - not in a lab, but in a side project. If you can find the time, this will be invaluable.</p>

<h3>#3. Start playing with APIs early</h3>


<p>Dont be scared of APIs! Theres a good chance at some point you will encounter an API towards the end of the semester, either in a lab or on one of your group projects. A few suggestions of really awesome, free APIs with good documentation: <a href="https://developers.google.com/maps/">Google Maps</a>, <a href="https://developer.foursquare.com/">Foursquare</a>, <a href="https://developer.spotify.com/web-api/">Spotify</a>, <a href="http://www.wunderground.com/weather/api/">Wunderground</a>, and <a href="https://nycopendata.socrata.com/">NYC Open Data</a> just to name a few. When you get to Hashketball and Green Grocer, dont get mad, get even. They will help make working with APIs super, super simple.</p>

<h3>#4. Dont just make the tests pass, read the tests.</h3>


<p>Testing is crazy useful and I wish I paid more attention to it during the semester. When working on a project Im excited about, I sometimes code like an ambulance driver going to a crash scene. Writing tests might seem boring, but there will come a time - likely during project mode or on a side project - where you will find yourself debugging a feature or a model and repeating yourself over and over again. At times I thought, I wont need to learn testing, Ill just program it right the first time! How arrogant I could (a.k.a. can) be!</p>

<p><img src="http://i.imgur.com/yheEw6x.gif" alt="dinners" /></p>

<p>While making a Potluck dinner organizer app, every time we wanted to test a feature, I had to create a new event by manually clicking around site to see what happened. Look how many I created! How much easier would it have been to write a test that could automate this process? Sometimes it felt like we were testing how fast I could create a new dinner!</p>

<p>Eventually your projects will just become to large to manually test the entire flow of a use case. Practice writing RSPEC and Capybara powered tests and let the computer do the work for you. Thats, after all, why were here.</p>

<h3>#5 Go on, git!</h3>


<p>As labs get bigger, get in the habit of using version control, branching, and merging your branches onto master. Dont code on your master branch! You can get away with it when working on your labs, but when you get to project mode you will want git to be second nature. Not only will it be there to save your ass when you delete something you shouldnt have, but its virtually impossible to collaborate on a big project without using git and github.</p>

<h3>#6 Remember why you came here</h3>


<p>I remember being a liberal arts, history major as an undergrad and EVERYTHING WAS SO IMPORTANT! Ideas, concepts, beliefs, principles, everything was so GD important. At Flatiron, that experience has been similar in its unique way. It is so easy to be overwhelmed by the amount there is to learn, the fear of having to get a job or learn a new language, stress at home from being so busy, getting pissed over group and table assignments, resenting your instructors for deploying labs in the wrong order or changing the schedule without telling you. I could go on</p>

<p>But when youre in the trenches it can be easy to focus all your energy on that one thing thats in front of you at the moment regardless of how insignificant it might be in the long run. Youre a passionate person, with beliefs, goddamnit! Thats why they accepted you in the first place. But in the throes of it all, it can be easy lose perspective of why you came to Flatiron for in the first place. If youre like me, coding is not some interest you decided to pursue on a lark. It is a lifeline, a guardian angel sent from heaven, a search and rescue mission to pull you from the rubble of your past. In short, a key to a better life. Remember what they tell you at the beginning of the semester. While at Flatiron you will learn to write code and program Ruby, but thats not really why youre there. You are there because you want to change your life.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/29/form-for-formed-forms/">Get Informed About Form_for Formed Forms</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-29T23:52:28-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:52 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Over the weekend, in building a super-fun, and very simple one page app called <a href="http://www.amiruby">Am I Ruby?</a> with Kate, Rachel, and Sophie, we stumbled upon a most curious feature of Rails.</p>

<p>Embracing object oriented design to the best of our abilities, we attempted to implement the so-called &ldquo;fat mode, skinny controller&rdquo; principle. Simply, most of the application specific logic should be in a model and the controller should serve only as a traffic cop routing information to and from views.</p>

<p>Seeing as this was a simple one page and no immediate need for persistence, our <code>search</code> model was a tableless. In other words, it was a plain old Ruby class.</p>

<p>After much of our application was built, we set up our controller:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SearchesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@search</span> <span class="o">=</span> <span class="no">Search</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@result</span> <span class="o">=</span> <span class="no">Search</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">am_i_ruby</span><span class="p">(</span><span class="n">search_params</span><span class="p">)</span>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>      <span class="n">f</span><span class="o">.</span><span class="n">html</span>
</span><span class='line'>      <span class="n">f</span><span class="o">.</span><span class="n">js</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">search_params</span>
</span><span class='line'>    <span class="n">params</span><span class="o">[</span><span class="ss">:search</span><span class="o">][</span><span class="ss">:keyword</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The controller would define a new <code>Search</code> model in order to serve up an object to the <code>form_for @search</code> in our main page&rsquo;s view.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= form_for(@search, remote: true) do |f| %&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:keyword</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s1">&#39;keyword&#39;</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=f.submit &quot;Search&quot;%&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We were feeling pretty good&hellip;until we saw this: <code>undefined method 'model_name' for #&lt;Search:0x007fbc18f959d0&gt;</code>. OUCH!! Especially since we never even wrote a method <code>model_name</code>&hellip;what gives?</p>

<p>A quick glance at the trace shows us this:
<img src="../images/errors.png"></p>

<p>Actionpack, activeview, activesupport&hellip;a lot of things I kind of recognize but am not super familiar about. About halfway down this huge trace I finally see one I do know about for sure: <code>activerecord</code>. Since our <code>Search</code> class was a tableless class, we never told it to inherit from ActiveRecord. So at some point, <code>form_for</code> tried to call <code>model_name</code> on a class that doesn&rsquo;t have access to that method. Let&rsquo;s assume that has something to do with ActiveRecord.</p>

<h3>Model Name</h3>

<p>As it turns out, rails form helpers rely heavily on ActiveRecord. It&rsquo;s not magic: at some point rails has to introspect on the object and be able to know what controller and action to send the submitted data and how to format the params hash. That&rsquo;s really it.</p>

<p><code>model_name</code> is a part of the ActiveModel module that helps rails with its naming conventions, magically pluralizing and singularizing our model names at will. How do we fix this? We have to give our class access to this method. We search for it and find where it lives in the rails source code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Search</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Refresh the page and we get a new error: <code>undefined method 'to_key' for #&lt;Search:0x007fbc1849fcb0&gt;</code>. <code>to_key</code> is also an activemodel method but not in the <code>Name</code> class, its in the <code>Conversion</code> class. What it does is return an array of all the object&rsquo;s attributes as keys. We&rsquo;re going to assume that those will later be used in <code>form_for</code>&rsquo;s creation of the params hash.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Search</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Conversion</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Refresh again, and we get another error: <code>undefined method 'persisted?'</code>. We know the drill by now: <code>persisted?</code> is an activerecord method that returns a boolean that tells us whether or not an object has been persisted to the database. At this point we have a couple of options.</p>

<p>We can define <code>persisted?</code> and basically be done. As long as the <code>Search</code> class has a defined attribute for every field in the form, the page will load error free.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Search</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Conversion</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">persisted?</span>
</span><span class='line'>    <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s not too bad. But I have an inquiring mind and want to keep pushing this further.</p>

<p>We can keep going down the rabbit hole of including/extending modules based on the error messages we find.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Search</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Conversion</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Persistence</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Core</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">ModelSchema</span><span class="o">::</span><span class="no">ClassMethods</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>But since I&rsquo;ve now added 5 modules, 3 of which are a part of ActiveRecord and its well after midnight and there&rsquo;s no end in sight, I&rsquo;m starting to get really tired of this. I have this feeling that all roads will at some point lead to <code>ActiveRecord::Base</code>.</p>

<p>When we look at the <a href="https://github.com/rails/rails/blob/master/activerecord/lib/active_record.rb">activerecord</a> source code, we find that <code>require 'active_model'</code> is literally the third line. In fact, <code>Base</code> has no code of its own - it just requires, includes, and extends nearly all the other <code>Active</code>modules in the Rails source code. So why not just make the class inherit from ActiveRecord and cover all our (ActiveRecord) bases?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Song</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So even though our model is not going to talk to a database, we can still give it all the functionality of &lsquo;tabled&rsquo; class that allows <code>form_for</code> to do its thing. But, if you&rsquo;re afraid this might confuse another developer (or future you), this is all you need to add to your class to allow it to interact with <code>form_for</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Search</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Conversion</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">persisted?</span>
</span><span class='line'>    <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/15/the-sql-was-better-than-the-original/">The SQL Was Better Than the Original</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-15T19:16:47-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:16 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the greatest benefits of developing rails applications with a framework like Ruby on Rails is the flexibility of being able to access a data from our databases without having to write ugly SQL statements. While SQL is a very powerful and efficient language for retrieving data, at least to this author, is nowhere near as elegant or intuitive as Ruby.</p>

<p>As part of the Rails framework, we have access to ActiveRecord, a Ruby DSL (domain specific language) that allows us to communicate with the database with ease. ActiveRecord builds out custom methods that erase the blood-brain barrier of database and our Ruby model classes. It allows our models to treat its relevant data as though they were were attributes of each instance of a particular class.</p>

<p>My first instinct as someonewho has recently fallen in love with Ruby is to try to do as much with that language as possible. The problem with that it is nowhere near as efficient as using a simple SQL statement. In our labs and early projects, that isnt really an issue as the size of our databases and programs dont require the efficiency of a larger scale application. But as students, we need to train ourselves to develop good coding habits! That is where ActiveRecord comes in to play.</p>

<h2>Experiment</h2>

<p><img src="http://static.fjcdn.com/pictures/For+science_3cf7fb_4751731.jpg" alt="For science!" /></p>

<p>To begin our test, I created a simple domain model that many of my Flatiron classmates would be very familiar with: <code>Artist</code> and <code>Song</code>. For every step along the way, I seed the database with a number of artists, and randomly assign them songs (at a rate of 100 songs per artist.)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'><span class="k">def</span> <span class="nf">make_artists</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span><span class='line'>  <span class="n">num</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>    <span class="n">artist</span> <span class="o">=</span> <span class="no">Artist</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">artist</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">make_songs</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span><span class='line'>  <span class="n">num</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>    <span class="n">song</span> <span class="o">=</span> <span class="no">Song</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:artist_id</span> <span class="o">=&gt;</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">100</span><span class="p">))</span>
</span><span class='line'>    <span class="n">song</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>For our experiment well be executing a simple query: Which artist has the most songs?</p>

<h2>Approach 1: Ruby</h2>

<p>We create a primitive data structure, load in our data and sort with basic ruby methods. We create a giant hash where each artist in the database is a key pointing to an array of each of their songs. We then sort by the size of values to find our artist with the most songs.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">most_songs_ruby</span>
</span><span class='line'>    <span class="nb">hash</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="no">Artist</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">artist</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">hash</span><span class="o">[</span><span class="n">artist</span><span class="o">]</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">songs</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">.</span><span class="n">max_by</span><span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Approach 2: ActiveRecord and SQL</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='Ruby'><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">most_songs_sql</span>
</span><span class='line'>    <span class="n">joins</span><span class="p">(</span><span class="ss">:songs</span><span class="p">)</span><span class="o">.</span>
</span><span class='line'>    <span class="n">group</span><span class="p">(</span><span class="ss">:artist_id</span><span class="p">)</span><span class="o">.</span>
</span><span class='line'>    <span class="n">order</span><span class="p">(</span><span class="s2">&quot;COUNT(*) DESC&quot;</span><span class="p">)</span><span class="o">.</span>
</span><span class='line'>    <span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Using ActiveRecord, we join up the <code>artists</code> and <code>songs</code> table, group our results by <code>artist_id</code>, and order our results by the count of songs each artist has. ActiveRecord then translates this into a SQL statement that queries our database.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='SQL'><span class='line'><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">songs</span>
</span><span class='line'><span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">artists</span> <span class="k">ON</span> <span class="n">artist_id</span> <span class="o">=</span> <span class="n">artists</span><span class="p">.</span><span class="n">id</span>
</span><span class='line'><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">artist_id</span>
</span><span class='line'><span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">DESC</span>
</span></code></pre></td></tr></table></div></figure>


<p>After each round of seeding, we run <code>puts Benchmark.measure {Artist.most_songs_sql}</code> and <code>puts Benchmark.measure {Artist.most_songs_ruby}</code> from a rails console to determine the speed of each querying method.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='SQL'><span class='line'><span class="o">|</span> <span class="n">Artists</span><span class="o">/</span><span class="n">Songs</span> <span class="o">|</span> <span class="n">Ruby</span> <span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">|</span> <span class="k">SQL</span> <span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">|</span> <span class="n">Mult</span><span class="p">.</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span><span class="c1">---------------|----------------|---------------|-------|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span>         <span class="o">|</span> <span class="p">.</span><span class="mi">117</span>           <span class="o">|</span> <span class="p">.</span><span class="mi">019</span>          <span class="o">|</span> <span class="mi">6</span><span class="p">.</span><span class="mi">2</span>   <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">5</span><span class="o">/</span><span class="mi">500</span>         <span class="o">|</span> <span class="p">.</span><span class="mi">088</span>           <span class="o">|</span> <span class="p">.</span><span class="mi">012</span>          <span class="o">|</span> <span class="mi">7</span><span class="p">.</span><span class="mi">4</span>   <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">10</span><span class="o">/</span><span class="mi">1000</span>       <span class="o">|</span> <span class="p">.</span><span class="mi">128</span>           <span class="o">|</span> <span class="p">.</span><span class="mi">012</span>          <span class="o">|</span> <span class="mi">10</span><span class="p">.</span><span class="mi">93</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">50</span><span class="o">/</span><span class="mi">5000</span>       <span class="o">|</span> <span class="p">.</span><span class="mi">183</span>           <span class="o">|</span> <span class="p">.</span><span class="mi">014</span>          <span class="o">|</span> <span class="mi">13</span><span class="p">.</span><span class="mi">44</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">100</span><span class="o">/</span><span class="mi">10000</span>     <span class="o">|</span> <span class="p">.</span><span class="mi">300</span>           <span class="o">|</span> <span class="p">.</span><span class="mi">015</span>          <span class="o">|</span> <span class="mi">19</span><span class="p">.</span><span class="mi">84</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">500</span><span class="o">/</span><span class="mi">50000</span>     <span class="o">|</span> <span class="mi">4</span><span class="p">.</span><span class="mi">396</span>          <span class="o">|</span> <span class="p">.</span><span class="mi">131</span>          <span class="o">|</span> <span class="mi">33</span><span class="p">.</span><span class="mi">43</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mi">1000</span><span class="o">/</span><span class="mi">100000</span>   <span class="o">|</span> <span class="mi">15</span><span class="p">.</span><span class="mi">830</span>         <span class="o">|</span> <span class="p">.</span><span class="mi">282</span>          <span class="o">|</span> <span class="mi">56</span><span class="p">.</span><span class="mi">12</span> <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Results</h2>

<p><img src="/images/efficiency.png"></p>

<p>Even with a small database, we immediately find SQL querying to be vastly faster than querying with Ruby. What slows us down in Ruby is needing to load every row from our database into a ruby object. The SQL code, on the other hand, sorts a pre-existing data structure and only needs to return 1 object into memory: the one artist with the most songs.</p>

<p>So even though finding the artist with the most songs when there are 10 artists in the database only takes 1/10 of a second with our Ruby method, ActiveRecord executes that query 10x faster.</p>

<p><img src="/images/seconds.png"></p>

<p>More importantly, we can see how quickly using Ruby to sort through data becomes inefficient. As our database grows in size, Ruby&rsquo;s sort times scale up with it. SQL sort times, just barely inch along. As a result, we find that as the dataset grows, SQL becomes even more efficient. So by the time there are 1000 artists and 100,000 songs in our database, SQL is approximately 60x faster. Our ruby method takes almost 17 seconds (a.k.a. You&rsquo;re fired).</p>

<p>As an aside, I found that because of how a Ruby interpreter stores objects in memory, repeating the method on the same dataset improved run times. However, we see similar improvements in SQL run times. And of course, this assumes a static dataset which we wouldn&rsquo;t find in the real world.</p>

<h2>Conclusion</h2>

<p>If you just need to pull one object out of the database(e.g. <code>Artist.find_by(:name =&gt; "Lady Gaga").songs</code>), Ruby is fine. But once you need to sort, calculate, count, or do anything else, go SQL or go home.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/26/buyer-beware/">Buyer Beware?</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-02-26T09:24:02-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:24 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since starting <a href="http://www.flatironschool.com">Flatiron School</a>, I&rsquo;ve seen an increasing number of articles about coding schools and bootcamps. Most of the coverage is pretty positive - generally people support the idea that a) learning to code is a valuable skill and b) education should as a general rule prepare people to enter the workforce.</p>

<p>But one article in the Washington Post that was recently sent my way bothered me a great deal. While it talks about some of the success stories from my coding school, the author isn&rsquo;t all positive.</p>

<blockquote><p>The bigger challenge, I fear, is how well these kinds of programs will scale.
Unlike most training programs, Flatiron is extraordinarily selective. Its admissions rate of 6 percent rivals Harvards. All admits must go through interviews with both co-founders and jump through other hoops such as coding a tic-tac-toe game (even if they have no background in programming). Its no wonder, then, that employers return again and again to Flatiron for high-quality hires: Flatiron has not only trained these students, but has also pre-screened them to make sure it ends up offering only the most perseverant, passionate, marketable workers around.</p></blockquote>

<p>I&rsquo;m encouraged by the success stories. I really did my research to try to get into the right school and hope to have the same success. But when the authors says that Flation is successful because it is so selective and &ldquo;The bigger challenge, I fear, is how well these kinds of programs will scale&rdquo; - this bothers me.</p>

<p>Doesn&rsquo;t everybody know the reason Harvard graduates are so successful is because Harvard is so selective? It&rsquo;s not the education - its the pre-screened candidates getting to build a life long professional network with other pre-screened students. Why is nobody asking that question about a liberal arts college education?</p>

<p>It is literally insane that we not only encourage but de facto require teenagers to virtually mortgage their futures to spend four years doing something that prepares them to enter an economy that existed in 1985 but has changed drastically today.</p>

<p>Part of the backlash, I wonder, is an entrenched workforce - both within tech and in other industries - who might somehow feel as if coding schools are &ldquo;cheating&rdquo; and not playing by a set of unspoken rules: pay your dues, do your time, and only then are you allowed to get a job. We sometimes have a tendency to put down another&rsquo;s route to make ourselves feel better about the fact that we took the scenic route.</p>

<p>So while yes - buyer beware of these coding programs and do your research as I did - but if someone wants to spend 10 or 15 thousand dollars learning to code people start to freak out, but an 18 year old can study creative writing at a small liberal arts college for 4 years of their life, spend $160,000 or be in debt for years with no immediate job prospects and no one bats an eye. Maybe policy makers do need to keep an eye on these new schools, but I wish that logic were applied to college too.</p>

<p>If it is incumbent on a professional school to put up high job placement numbers, why don&rsquo;t we hold college to the same standard? If Flatiron and similar schools are successful I don&rsquo;t think the end result will necessarily be that everyone will skip college for technical training - my hope is that their success will force colleges to take a look what they are doing to prepare students to enter the world.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/12/07/seinfeld-rankings/">Seinfeld Rankings Part II</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/04/ranking-seinfeld-seasons/">Ranking Seinfeld Seasons</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/18/the-good-parts/">The Good Parts</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/13/accessing-shadow-dom-elements-with-selenium-webdriver/">Accessing Shadow DOM Elements With Selenium Webdriver</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/28/checksum-gives-me-indigestion/">Checksum Gives Me Indigestion</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Jeremy Sklarsky -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
