
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Yelp! I Need Some Data, Not Just Any Data&#8230; - Jeremy Sklarsky</title>
  <meta name="author" content="Jeremy Sklarsky">

  
  <meta name="description" content="Authors note: This is my first ever post! Background My first two weeks at Flatiron School have been an absolute whirlwind. I can feel us slowly &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jeremysklarsky.github.io/blog/2015/02/14/yelp-i-need-some-data/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jeremy Sklarsky" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jeremy Sklarsky</a></h1>
  
    <h2>The World Wide Web is My Oyster.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="jeremysklarsky.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Yelp! I Need Some Data, Not Just Any Data&#8230;</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-02-14T12:31:14-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:31 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p><em>Authors note: This is my first ever post!</em></p>

<h2>Background</h2>

<p>My first two weeks at <a href="http://www.flatironschool.com">Flatiron School</a> have been an absolute whirlwind. I can feel us slowly approaching a time when we can <strong>actually</strong> deploy our skills and do something useful.</p>

<p>Diving into Ruby headfirst has been a joy, though it remained largely in the realm of theoretical and hypothetical. I&rsquo;m not one scoff at intellectual exercises for their own sake, but the painstaking task of iterating over made up hashes was starting to test my own powers of concentration and emotional constitution.</p>

<p>Among the more powerful lectures have involved data scraping and parsing demonstrations.</p>

<p>In a couple of quick clicks our lead <s>guru</s> instructor managed to pull all the prices of every apartment listed on craigslist and find the average. Looks like we haven&rsquo;t been iterating for nothing. BOOM!</p>

<p><img src="http://media.giphy.com/media/QMcamps7Gzj2g/giphy.gif" alt="Kramer Shocked" />
<br>^everyone in class.</p>

<h2>Writing a Yelp-er Method</h2>

<p>That looked like fun and I wanted a turn. For some years I&rsquo;ve been fairly obsessed with data collection and manipulation. But my participation in the sport was limited by both, obviously, my data collection and manipulation abilities. But no longer! In my first two weeks as a developer, I&rsquo;ve learned to adopt the idea that I am not limited by what my computer tells me what I&rsquo;m allowed to do. It is a tool to do my bidding!</p>

<p>For my test case, I thought scraping <a href="http://www.yelp.com">Yelp</a> would be a good place to start. After a few clicks, I realized the easiest way to access Yelp&rsquo;s API would not be parsing a long JSON string like we had in the Spotify lab. Luckily for you, dear readers, <a href="http://www.yelp.com/developers/documentation/v2/overview">Yelp&rsquo;s API documentation</a> lead us to a very helpful Ruby gem for parsing search results directly into a hash with tons of data pertaining to your search.</p>

<p>Let&rsquo;s get started:<br>
1. In terminal, run &lsquo;gem install yelp&rsquo;.<br>
2. &lsquo;require yelp&rsquo; in your ruby program, or include &lsquo;yelp&rsquo; in your gemfile.<br>
3. Make a million dollars.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;yelp&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">client</span> <span class="o">=</span> <span class="no">Yelp</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">({</span> <span class="ss">consumer_key</span><span class="p">:</span> <span class="no">YOUR_CONSUMER_KEY</span><span class="p">,</span>
</span><span class='line'>                            <span class="ss">consumer_secret</span><span class="p">:</span> <span class="no">YOUR_CONSUMER_SECRET</span><span class="p">,</span>
</span><span class='line'>                            <span class="ss">token</span><span class="p">:</span> <span class="no">YOUR_TOKEN</span><span class="p">,</span>
</span><span class='line'>                            <span class="ss">token_secret</span><span class="p">:</span> <span class="no">YOUR_TOKEN_SECRET</span>
</span><span class='line'>                          <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>When the interpreter runs this code, your client object has access to all of the methods defined in the gem. You interact with Yelp&rsquo;s data by using a the parameters laid out in their API within the gem&rsquo;s syntax. Yelp gives you plenty of helpful tags to customize your search. Check out the <a href="http://www.yelp.com/developers/documentation/v2/search_api">documentation</a> in the search API for some of them.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">italian_places</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span> <span class="n">k</span><span class="o">[</span><span class="n">v</span><span class="o">]</span> <span class="o">=</span> <span class="p">{}}</span>
</span><span class='line'>
</span><span class='line'><span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">term</span><span class="p">:</span> <span class="s1">&#39;italian&#39;</span><span class="p">,</span>
</span><span class='line'>           <span class="ss">category_filter</span><span class="p">:</span> <span class="s1">&#39;restaurants&#39;</span>
</span><span class='line'>         <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">locale</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">cc</span><span class="p">:</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span> <span class="ss">lang</span><span class="p">:</span> <span class="s1">&#39;en&#39;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Park Slope&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">locale</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>For our test search, I focused on some pretty basic ones: search for Italian restaurants in the nearby neighborhood of Park Slope. The return of this search is an array like object called a Burst, which contains instances of Business objects.</p>

<p>Yelp then has a separate <a href="http://www.yelp.com/developers/documentation/v2/business">Business API</a> for accessing the info in the returned data structure. The gem lets us call them as methods on each individual business object returned in the Burst. Here are a few of the major ones.</p>

<!---Business API methods-->


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">## search</span>
</span><span class='line'><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;San Francisco&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="n">businesses</span>
</span><span class='line'><span class="c1"># [&lt;Business 1&gt;, &lt;Business 2&gt;, ...]</span>
</span><span class='line'>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="n">businesses</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">name</span>
</span><span class='line'><span class="c1"># &quot;Kim Makoi, DC&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="n">businesses</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">rating</span>
</span><span class='line'><span class="c1"># 5.0</span>
</span><span class='line'>
</span><span class='line'><span class="c1">## business</span>
</span><span class='line'><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">business</span><span class="p">(</span><span class="s1">&#39;yelp-san-francisco&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="c1"># Yelp</span>
</span><span class='line'>
</span><span class='line'><span class="n">response</span><span class="o">.</span><span class="n">categories</span>
</span><span class='line'><span class="c1"># [[&quot;Local Flavor&quot;, &quot;localflavor&quot;], [&quot;Mass Media&quot;, &quot;massmedia&quot;]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now here is the fun part: parsing the data. We can then iterate through each object&rsquo;s keys and store the values in our own hash, which I&rsquo;ve created and called italian_places.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Park Slope&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">locale</span><span class="p">)</span><span class="o">.</span><span class="n">businesses</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">place</span><span class="o">|</span>
</span><span class='line'>  <span class="n">italian_places</span><span class="o">[</span><span class="n">place</span><span class="o">.</span><span class="n">name</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">:review_count</span> <span class="o">=&gt;</span> <span class="n">place</span><span class="o">.</span><span class="n">review_count</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">:rating</span> <span class="o">=&gt;</span> <span class="n">place</span><span class="o">.</span><span class="n">rating</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">:phone</span> <span class="o">=&gt;</span> <span class="n">place</span><span class="o">.</span><span class="n">phone</span><span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>For the moment, I can&rsquo;t seem to get more than ~17 results to show up. This may have something to do with my amateurish Yelp authorization key. In any event,
the results look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">italian_places</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'> <span class="s2">&quot;Piccoli Trattoria&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">213</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7187880066&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Al Di La Trattoria&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">516</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7186368888&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Peppino&#39;s&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">218</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7187687244&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Mariella&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">62</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7184992132&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Scottadito Osteria Toscana&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">484</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7186364800&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Giovanni&#39;s Brooklyn Eats&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">178</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7187888001&quot;</span><span class="p">},</span>
</span><span class='line'> <span class="s2">&quot;Scalino&quot;</span><span class="o">=&gt;</span><span class="p">{</span><span class="ss">:review_count</span><span class="o">=&gt;</span><span class="mi">142</span><span class="p">,</span> <span class="ss">:rating</span><span class="o">=&gt;</span><span class="mi">4</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:phone</span><span class="o">=&gt;</span><span class="s2">&quot;7188405738&quot;</span><span class="p">}}</span>
</span></code></pre></td></tr></table></div></figure>


<p>From there we have a hash with which we can do anything we want. Sort by rating, sort by rating and most reviews, create adjusted ratings for restaurant categories based on the category average (i.e. grading the restaurant on a curve), whatever we want. The world (wide web) is our oyster!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jeremy Sklarsky</span></span>

      




<time class='entry-date' datetime='2015-02-14T12:31:14-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:31 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://jeremysklarsky.github.io/blog/2015/02/14/yelp-i-need-some-data/" data-via="" data-counturl="http://jeremysklarsky.github.io/blog/2015/02/14/yelp-i-need-some-data/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/blog/2015/02/15/bash-how-i-learned-to-stop-worrying-and-love-the-terminal/" title="Next Post: Bash: How I learned to stop worrying and love the Terminal">Bash: How I learned to stop worrying and love the Terminal &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/28/checksum-gives-me-indigestion/">Checksum Gives Me Indigestion</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/26/life-or-death-the-emperors-proposition/">Life or Death? The Emperor&#8217;s Proposition</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/12/so-long/">So Long, Farewell, Auf Wiedersehen, Goodbye</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/29/form-for-formed-forms/">Get Informed About Form_for Formed Forms</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/15/the-sql-was-better-than-the-original/">The SQL Was Better Than the Original</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Jeremy Sklarsky -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
